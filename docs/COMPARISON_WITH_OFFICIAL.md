# Claude Code Open vs Official @anthropic-ai/claude-code å¯¹æ¯”åˆ†æ

æœ¬æ–‡æ¡£è¯¦ç»†å¯¹æ¯”äº†æœ¬é¡¹ç›®ï¼ˆclaude-code-openï¼‰ä¸å®˜æ–¹ @anthropic-ai/claude-code v2.0.76 çš„å·®å¼‚ã€‚

## 1. åŒ…ç»“æ„å¯¹æ¯”

### å®˜æ–¹åŒ…ç»“æ„
```
@anthropic-ai/claude-code (v2.0.76)
â”œâ”€â”€ cli.js           (11MB, å•æ–‡ä»¶æ‰“åŒ…/æ··æ·†åçš„ä»£ç )
â”œâ”€â”€ package.json     (æ— è¿è¡Œæ—¶ä¾èµ–)
â”œâ”€â”€ sdk-tools.d.ts   (65KB, å·¥å…·ç±»å‹å®šä¹‰)
â”œâ”€â”€ resvg.wasm       (2.5MB)
â”œâ”€â”€ tree-sitter.wasm (205KB)
â”œâ”€â”€ tree-sitter-bash.wasm (1.4MB)
â”œâ”€â”€ bun.lock
â”œâ”€â”€ LICENSE.md
â”œâ”€â”€ README.md
â””â”€â”€ vendor/
    â””â”€â”€ ripgrep/     (å„å¹³å°é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶)
        â”œâ”€â”€ arm64-darwin/
        â”œâ”€â”€ arm64-linux/
        â”œâ”€â”€ x64-darwin/
        â”œâ”€â”€ x64-linux/
        â””â”€â”€ x64-win32/
```

### æœ¬é¡¹ç›®ç»“æ„
```
claude-code-open (v2.0.76)
â”œâ”€â”€ src/             (TypeScript æºä»£ç )
â”‚   â”œâ”€â”€ cli.ts       (å…¥å£)
â”‚   â”œâ”€â”€ core/        (æ ¸å¿ƒå¼•æ“)
â”‚   â”œâ”€â”€ tools/       (å·¥å…·å®ç°)
â”‚   â”œâ”€â”€ mcp/         (MCP é›†æˆ)
â”‚   â”œâ”€â”€ context/     (ä¸Šä¸‹æ–‡ç®¡ç†)
â”‚   â”œâ”€â”€ hooks/       (é’©å­ç³»ç»Ÿ)
â”‚   â””â”€â”€ ... (20+ æ¨¡å—)
â”œâ”€â”€ dist/            (ç¼–è¯‘è¾“å‡º)
â”œâ”€â”€ package.json     (åŒ…å«å…¨éƒ¨ä¾èµ–)
â””â”€â”€ docs/
```

## 2. ä¾èµ–å¯¹æ¯”

### å®˜æ–¹åŒ…
- **æ— è¿è¡Œæ—¶ä¾èµ–** - æ‰€æœ‰ä»£ç æ‰“åŒ…åˆ°å•ä¸ª cli.js æ–‡ä»¶
- **å¯é€‰ä¾èµ–**: @img/sharp-* (å›¾åƒå¤„ç†)
- ä½¿ç”¨ Bun æ‰“åŒ… (æœ‰ bun.lock æ–‡ä»¶)

### æœ¬é¡¹ç›®
```json
"dependencies": {
  "@anthropic-ai/sdk": "^0.32.0",
  "axios": "^1.6.0",
  "chalk": "^5.3.0",
  "cheerio": "^1.0.0",
  "commander": "^12.0.0",
  "glob": "^10.3.0",
  "ink": "^5.0.0",
  "marked": "^12.0.0",
  "react": "^18.2.0",
  "sharp": "^0.33.0",
  "tree-sitter": "^0.25.0",
  "web-tree-sitter": "^0.26.3",
  "zod": "^3.22.0",
  // ... æ›´å¤šä¾èµ–
}
```

## 3. å·¥å…·å¯¹æ¯”

### å®˜æ–¹æ”¯æŒçš„å·¥å…· (æ¥è‡ª sdk-tools.d.ts)

| å·¥å…·å | æœ¬é¡¹ç›®å®ç° | çŠ¶æ€ |
|--------|-----------|------|
| AgentInput (Task) | TaskTool | âœ… å·²å®ç° |
| BashInput | BashTool | âœ… å·²å®ç° |
| TaskOutputInput | TaskOutputTool | âœ… å·²å®ç° |
| ExitPlanModeInput | ExitPlanModeTool | âœ… å·²å®ç° |
| FileEditInput (Edit) | EditTool | âœ… å·²å®ç° |
| FileReadInput (Read) | ReadTool | âœ… å·²å®ç° |
| FileWriteInput (Write) | WriteTool | âœ… å·²å®ç° |
| GlobInput | GlobTool | âœ… å·²å®ç° |
| GrepInput | GrepTool | âœ… å·²å®ç° |
| KillShellInput | KillShellTool | âœ… å·²å®ç° |
| ListMcpResourcesInput | ListMcpResourcesTool | âœ… å·²å®ç° |
| McpInput | MCPTool | âœ… å·²å®ç° |
| NotebookEditInput | NotebookEditTool | âœ… å·²å®ç° |
| ReadMcpResourceInput | ReadMcpResourceTool | âœ… å·²å®ç° |
| TodoWriteInput | TodoWriteTool | âœ… å·²å®ç° |
| WebFetchInput | WebFetchTool | âœ… å·²å®ç° |
| WebSearchInput | WebSearchTool | âœ… å·²å®ç° |
| AskUserQuestionInput | AskUserQuestionTool | âœ… å·²å®ç° |

### æœ¬é¡¹ç›®é¢å¤–å·¥å…·
- **MultiEditTool** - æ‰¹é‡ç¼–è¾‘
- **TmuxTool** - Tmux é›†æˆ
- **SkillTool** - æŠ€èƒ½ç³»ç»Ÿ
- **SlashCommandTool** - æ–œæ å‘½ä»¤
- **LSPTool** - LSP é›†æˆ
- **BashOutputTool** - åå° Bash è¾“å‡º
- **EnterPlanModeTool** - è¿›å…¥è®¡åˆ’æ¨¡å¼
- **ListAgentsTool** - åˆ—å‡ºä»£ç†

## 4. å…³é”®åŠŸèƒ½å¯¹æ¯”

### å®˜æ–¹ç‰ˆæœ¬ç‰¹æœ‰åŠŸèƒ½ (ä» cli.js åˆ†æ)

| åŠŸèƒ½ | æè¿° | æœ¬é¡¹ç›®çŠ¶æ€ |
|------|------|-----------|
| æ’ä»¶ç³»ç»Ÿ | å®Œæ•´çš„ marketplace/plugin ç®¡ç† | âš ï¸ æ¡†æ¶å·²æœ‰ï¼ŒåŠŸèƒ½å¾…å®Œå–„ |
| ä¼ä¸šç­–ç•¥ | strictKnownMarketplaces, blockedMarketplaces | âš ï¸ Schema å®šä¹‰å­˜åœ¨ |
| é’©å­ç³»ç»Ÿ | command/prompt/agent ä¸‰ç§ç±»å‹é’©å­ | âœ… åŸºç¡€å®ç° |
| æƒé™ç³»ç»Ÿ | å¤æ‚çš„æƒé™éªŒè¯å’Œç­–ç•¥ | âš ï¸ åŸºç¡€å®ç° |
| æ²™ç®±å®‰å…¨ | Bubblewrap sandbox éš”ç¦» | âœ… å·²å®ç° |
| å¢é‡ TUI | å¢é‡å¼ç»ˆç«¯ UI æ¸²æŸ“ | âš ï¸ éƒ¨åˆ†å®ç° |
| é¥æµ‹ | OpenTelemetry é›†æˆ | âš ï¸ æ¡†æ¶å­˜åœ¨ |
| ä»£ç ç­¾å | codesign åŠŸèƒ½ | âš ï¸ æ¡†æ¶å­˜åœ¨ |
| LSP é›†æˆ | è¯­è¨€æœåŠ¡å™¨åè®®æ”¯æŒ | âœ… å·²å®ç° |
| Ripgrep | å†…ç½® ripgrep äºŒè¿›åˆ¶ | âœ… å·²å®ç° |

### å®˜æ–¹ç‰ˆæœ¬çš„é«˜çº§ç‰¹æ€§

1. **å®Œæ•´çš„ MCP (Model Context Protocol) å®ç°**
   - æ”¯æŒ stdio, socket, websocket ä¼ è¾“
   - å®Œæ•´çš„ sampling, resources, tools åè®®
   - æœåŠ¡å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
   - å–æ¶ˆæœºåˆ¶ (cancellation)

2. **ä¼ä¸šçº§å®‰å…¨**
   - ä¸¥æ ¼çš„å¸‚åœºæ¥æºæ§åˆ¶ (strictKnownMarketplaces)
   - æœåŠ¡å™¨é»‘åå• (blockedMarketplaces, deniedMcpServers)
   - æ²™ç®±ç½‘ç»œæ§åˆ¶
   - Hook æƒé™éš”ç¦» (allowManagedHooksOnly)

3. **é«˜çº§ UI åŠŸèƒ½**
   - Hyperlink æ”¯æŒ
   - è¿›åº¦æ¡ (iTerm2 é£æ ¼)
   - å¤æ‚çš„ ANSI åºåˆ—è§£æ
   - å¢é‡æ¸²æŸ“

## 5. ç³»ç»Ÿæç¤ºè¯å¯¹æ¯”

å®˜æ–¹ç‰ˆæœ¬çš„ç³»ç»Ÿæç¤ºè¯åŒ…å«ï¼š
- è¯¦ç»†çš„å·¥å…·ä½¿ç”¨è¯´æ˜
- Git æ“ä½œåè®® (commit, PR åˆ›å»º)
- å®‰å…¨çº¦æŸ
- ä»£ç†ç³»ç»Ÿè¯´æ˜
- è®¡åˆ’æ¨¡å¼è¯´æ˜

æœ¬é¡¹ç›®éœ€è¦å‚è€ƒå®˜æ–¹å®ç°å®Œå–„ç³»ç»Ÿæç¤ºè¯ã€‚

## 6. å·®è·æ€»ç»“

### å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½ âœ…
1. æ‰€æœ‰ 17 ä¸ªå®˜æ–¹å·¥å…·
2. åŸºç¡€çš„ MCP é›†æˆ
3. ä¼šè¯ç®¡ç†å’ŒæŒä¹…åŒ–
4. é’©å­ç³»ç»Ÿæ¡†æ¶
5. æ’ä»¶ç³»ç»Ÿæ¡†æ¶
6. æ²™ç®±å®‰å…¨
7. Ripgrep æœç´¢
8. Tree-sitter ä»£ç è§£æ
9. Ink ç»ˆç«¯ UI

### éœ€è¦å®Œå–„çš„åŠŸèƒ½ âš ï¸
1. **æ’ä»¶/Marketplace ç³»ç»Ÿ** - éœ€è¦å®Œæ•´çš„å®‰è£…ã€æ›´æ–°ã€å¸è½½æµç¨‹
2. **ä¼ä¸šç­–ç•¥** - æ›´å®Œæ•´çš„ç­–ç•¥æ‰§è¡Œ
3. **é¥æµ‹ç³»ç»Ÿ** - OpenTelemetry å®Œæ•´é›†æˆ
4. **é«˜çº§ UI** - å¢é‡æ¸²æŸ“ã€å¤æ‚æ ·å¼
5. **ç³»ç»Ÿæç¤ºè¯** - éœ€è¦æ›´å®Œæ•´çš„æŒ‡ä»¤

### æ¶æ„å·®å¼‚ ğŸ”„
1. **å®˜æ–¹**: å•æ–‡ä»¶æ‰“åŒ…ï¼Œæ— è¿è¡Œæ—¶ä¾èµ–ï¼Œä½¿ç”¨ Bun
2. **æœ¬é¡¹ç›®**: æ¨¡å—åŒ– TypeScriptï¼Œä¾èµ– npm åŒ…ï¼Œä½¿ç”¨ Node.js

### ç¼ºå¤±çš„å…·ä½“åŠŸèƒ½ âŒ
1. å®Œæ•´çš„ AskUserQuestion UI (å¤šé€‰é¡¹é—®é¢˜)
2. ä»£ç ç­¾åéªŒè¯
3. æŸäº› CLI é€‰é¡¹å’Œé…ç½®
4. ä¸€äº›è¾¹ç¼˜æƒ…å†µå¤„ç†

## 7. å»ºè®®æ”¹è¿›æ–¹å‘

1. **çŸ­æœŸ** (é«˜ä¼˜å…ˆçº§)
   - å®Œå–„ AskUserQuestionTool çš„ UI å®ç°
   - å¢å¼ºç³»ç»Ÿæç¤ºè¯
   - æ”¹è¿›é”™è¯¯å¤„ç†

2. **ä¸­æœŸ**
   - å®Œæ•´å®ç° Marketplace/Plugin å®‰è£…æµç¨‹
   - å¢å¼º MCP åè®®æ”¯æŒ
   - æ·»åŠ æ›´å¤šæµ‹è¯•

3. **é•¿æœŸ**
   - è€ƒè™‘ä½¿ç”¨ Bun æ‰“åŒ…ä»¥å‡å°‘ä¾èµ–
   - ä¼ä¸šçº§å®‰å…¨åŠŸèƒ½
   - æ€§èƒ½ä¼˜åŒ–

## 8. ç‰ˆæœ¬å…¼å®¹æ€§

æœ¬é¡¹ç›®ç‰ˆæœ¬å·ä¸å®˜æ–¹åŒæ­¥ä¸º 2.0.76ï¼Œä½†ï¼š
- API æ¥å£åŸºæœ¬å…¼å®¹
- å·¥å…·å®šä¹‰ä¸å®˜æ–¹åŒ¹é…
- é…ç½®æ–‡ä»¶æ ¼å¼å…¼å®¹

---

*æœ€åæ›´æ–°: 2025-12-26*
*å¯¹æ¯”ç‰ˆæœ¬: @anthropic-ai/claude-code v2.0.76*
